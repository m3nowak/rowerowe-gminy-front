<!-- https://raw.githubusercontent.com/go2garret/maps/main/src/assets/json/openStreetMap.json -->
<div class="h-flex-content h-flex-container">
<mgl-map
  class="map-container h-flex-content"
  [style]="(mapDisplaySettings$ | async)!"
  [zoom]="[6]"
  [center]="[19.42366667, 52.11433333]"
  (mapLoad)="onMapLoad($event)"
  [preserveDrawingBuffer]="true"
  [attributionControl]="false"
>
  <mgl-control mglAttribution position="top-left" [compact]="true" [customAttribution]="'Mapbox | geoportal.gov.pl'"></mgl-control>
  @if (featureCollection$ | async; as nfc){
  <!-- <ng-container *ngIf="fcStatic as features"> -->
  <mgl-geojson-source id="borders" [data]="nfc.data" promoteId="TERYT"> </mgl-geojson-source>
  
  <mgl-layer
    id="borders"
    type="fill"
    source="borders"
    [filter]="['get', 'isUnlocked']"
    (layerClick)="onLayerClick($event)"
    [paint]="{
        'fill-antialias': true,
        'fill-color': [
          'match',
          ['get', 'type'],
          'WOJ',
          '#581D89',
          'POW',
          '#004080',
          'GMI',
          '#1B9300',
          '#C94C00'
        ],
        'fill-opacity': 0.50,
    }"
  >
  </mgl-layer>
  <mgl-layer
    id="borders-lines"
    type="line"
    source="borders"
    [filter]="['==', ['get', 'type'], 'GMI']"
    [paint]="{
        'line-color': '#400',
        'line-width': [
          'interpolate',
          ['linear'],
          ['zoom'],
          6,
          0,
          24,
          2
        ],
    }"
  >
  </mgl-layer>
  } 
  <!-- @if (selectedFeature$ | async; as selectedFeature){
  <mgl-popup [lngLat]="selectedFeature.lngLat" [closeButton]="false" [closeOnClick]="false">
    <span class="map-popup">Nazwa: {{ selectedFeature.name }}, kod TERYT: {{ selectedFeature.teryt }}</span>
  </mgl-popup>
  } -->
</mgl-map>
@if (showPopup) {
<div class="map-popup h-flex-container">
  <app-map-popup class="h-flex-content h-flex-container" (close)="popupClose()"/>
</div>
}
</div>